/*
 * OpenSeadragon
 *
 * Copyright (C) 2009 CodePlex Foundation
 * Copyright (C) 2010-2013 OpenSeadragon contributors
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 * - Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 *
 * - Redistributions in binary form must reproduce the above copyright
 *   notice, this list of conditions and the following disclaimer in the
 *   documentation and/or other materials provided with the distribution.
 *
 * - Neither the name of CodePlex Foundation nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/*
 * Portions of this source file taken from jQuery:
 *
 * Copyright 2011 John Resig
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/*
 * Portions of this source file taken from mattsnider.com:
 *
 * Copyright (c) 2006-2013 Matt Snider
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
 * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT
 * OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
 * THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

(function(e){var t;define([],function(){return function(){window.OpenSeadragon=window.OpenSeadragon||function(e){return new OpenSeadragon.Viewer(e)},function(e){e.version={versionStr:"<%= osdVersion.versionStr %>",major:parseInt("<%= osdVersion.major %>",10),minor:parseInt("<%= osdVersion.minor %>",10),revision:parseInt("<%= osdVersion.revision %>",10)};var t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},n=Object.prototype.toString,r=Object.prototype.hasOwnProperty;e.isFunction=function(t){return e.type(t)==="function"},e.isArray=Array.isArray||function(t){return e.type(t)==="array"},e.isWindow=function(e){return e&&typeof e=="object"&&"setInterval"in e},e.type=function(e){return e===null||e===undefined?String(e):t[n.call(e)]||"object"},e.isPlainObject=function(t){if(!t||OpenSeadragon.type(t)!=="object"||t.nodeType||e.isWindow(t))return!1;if(t.constructor&&!r.call(t,"constructor")&&!r.call(t.constructor.prototype,"isPrototypeOf"))return!1;var n;for(n in t);return n===undefined||r.call(t,n)},e.isEmptyObject=function(e){for(var t in e)return!1;return!0},e.supportsCanvas=function(){var t=document.createElement("canvas");return!!e.isFunction(t.getContext)&&!!t.getContext("2d")}()}(OpenSeadragon),function(e){function i(e,t){return t&&e!=document.body?document.body:e.offsetParent}function s(t,n){var r,i,s=null;if(!t)throw new Error(e.getString("Errors.Security"));if(t.status!==200&&t.status!==0)throw r=t.status,i=r==404?"Not Found":t.statusText,new Error(e.getString("Errors.Status",r,i));return t.responseXML&&t.responseXML.documentElement?s=t.responseXML:t.responseText&&(s=e.parseXml(t.responseText)),o(s,n)}function o(t,n){if(!t||!t.documentElement)throw new Error(e.getString("Errors.Xml"));var r=t.documentElement,i=r.tagName;if(i=="Image")try{return u(r,n)}catch(s){throw s instanceof Error?s:new Error(e.getString("Errors.Dzi"))}else{if(i=="Collection")throw new Error(e.getString("Errors.Dzc"));if(i=="Error")return e._processDZIError(r)}throw new Error(e.getString("Errors.Dzi"))}function u(t,n){var r=t.getAttribute("Format"),i=t.getElementsByTagName("Size")[0],s=t.getElementsByTagName("DisplayRect"),o=parseInt(i.getAttribute("Width"),10),u=parseInt(i.getAttribute("Height"),10),a=parseInt(t.getAttribute("TileSize"),10),f=parseInt(t.getAttribute("Overlap"),10),l=[],c,h,p;if(!e.imageFormatSupported(r))throw new Error(e.getString("Errors.ImageFormat",r.toUpperCase()));for(p=0;p<s.length;p++)c=s[p],h=c.getElementsByTagName("Rect")[0],l.push(new e.DisplayRect(parseInt(h.getAttribute("X"),10),parseInt(h.getAttribute("Y"),10),parseInt(h.getAttribute("Width"),10),parseInt(h.getAttribute("Height"),10),0,parseInt(c.getAttribute("MaxLevel"),10)));return new e.DziTileSource(o,u,a,f,n,r,l)}function a(t,n){var r=t.Format,i=t.Size,s=t.DisplayRect||[],o=parseInt(i.Width,10),u=parseInt(i.Height,10),a=parseInt(t.TileSize,10),f=parseInt(t.Overlap,10),l=[],c,h;if(!e.imageFormatSupported(r))throw new Error(e.getString("Errors.ImageFormat",r.toUpperCase()));for(h=0;h<s.length;h++)c=s[h].Rect,l.push(new e.DisplayRect(parseInt(c.X,10),parseInt(c.Y,10),parseInt(c.Width,10),parseInt(c.Height,10),0,parseInt(c.MaxLevel,10)));return new e.DziTileSource(o,u,a,f,n,r,l)}e.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=arguments.length,a=!1,f=1;typeof o=="boolean"&&(a=o,o=arguments[1]||{},f=2),typeof o!="object"&&!OpenSeadragon.isFunction(o)&&(o={}),u===f&&(o=this,--f);for(;f<u;f++){e=arguments[f];if(e!==null||e!==undefined)for(t in e){n=o[t],r=e[t];if(o===r)continue;a&&r&&(OpenSeadragon.isPlainObject(r)||(i=OpenSeadragon.isArray(r)))?(i?(i=!1,s=n&&OpenSeadragon.isArray(n)?n:[]):s=n&&OpenSeadragon.isPlainObject(n)?n:{},o[t]=OpenSeadragon.extend(a,s,r)):r!==undefined&&(o[t]=r)}}return o},e.extend(e,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,pixelsPerWheelLine:40,autoResize:!0,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorRotate:!0,degrees:0,opacity:1,layersAspectRatioEpsilon:1e-4,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:"#437AB2"},SIGNAL:"----seadragon----",delegate:function(e,t){return function(){var n=arguments;return n===undefined&&(n=[]),t.apply(e,n)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return typeof e=="string"&&(e=document.getElementById(e)),e},getElementPosition:function(t){var n=new e.Point,r,s;t=e.getElement(t),r=e.getElementStyle(t).position=="fixed",s=i(t,r);while(s)n.x+=t.offsetLeft,n.y+=t.offsetTop,r&&(n=n.plus(e.getPageScroll())),t=s,r=e.getElementStyle(t).position=="fixed",s=i(t,r);return n},getElementOffset:function(t){t=e.getElement(t);var n=t&&t.ownerDocument,r,i,s={top:0,left:0};return n?(r=n.documentElement,typeof t.getBoundingClientRect!=typeof undefined&&(s=t.getBoundingClientRect()),i=n==n.window?n:n.nodeType===9?n.defaultView||n.parentWindow:!1,new e.Point(s.left+(i.pageXOffset||r.scrollLeft)-(r.clientLeft||0),s.top+(i.pageYOffset||r.scrollTop)-(r.clientTop||0))):new e.Point},getElementSize:function(t){return t=e.getElement(t),new e.Point(t.clientWidth,t.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(t){return t=e.getElement(t),t.currentStyle}:function(t){return t=e.getElement(t),window.getComputedStyle(t,"")},pointInElement:function(t,n){t=e.getElement(t);var r=e.getElementOffset(t),i=e.getElementSize(t);return n.x>=r.x&&n.x<r.x+i.x&&n.y<r.y+i.y&&n.y>=r.y},getEvent:function(t){return t?e.getEvent=function(e){return e}:e.getEvent=function(){return window.event},e.getEvent(t)},getMousePosition:function(t){if(typeof t.pageX=="number")e.getMousePosition=function(t){var n=new e.Point;return t=e.getEvent(t),n.x=t.pageX,n.y=t.pageY,n};else{if(typeof t.clientX!="number")throw new Error("Unknown event mouse position, no known technique.");e.getMousePosition=function(t){var n=new e.Point;return t=e.getEvent(t),n.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,n}}return e.getMousePosition(t)},getPageScroll:function(){var t=document.documentElement||{},n=document.body||{};if(typeof window.pageXOffset=="number")e.getPageScroll=function(){return new e.Point(window.pageXOffset,window.pageYOffset)};else if(n.scrollLeft||n.scrollTop)e.getPageScroll=function(){return new e.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!t.scrollLeft&&!t.scrollTop)return new e.Point(0,0);e.getPageScroll=function(){return new e.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return e.getPageScroll()},setPageScroll:function(t){if(typeof window.scrollTo!="undefined")e.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var n=e.getPageScroll();if(n.x===t.x&&n.y===t.y)return;document.body.scrollLeft=t.x,document.body.scrollTop=t.y;var r=e.getPageScroll();if(r.x!==n.x&&r.y!==n.y){e.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y};return}document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y,r=e.getPageScroll();if(r.x!==n.x&&r.y!==n.y){e.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y};return}e.setPageScroll=function(e){}}return e.setPageScroll(t)},getWindowSize:function(){var t=document.documentElement||{},n=document.body||{};if(typeof window.innerWidth=="number")e.getWindowSize=function(){return new e.Point(window.innerWidth,window.innerHeight)};else if(t.clientWidth||t.clientHeight)e.getWindowSize=function(){return new e.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!n.clientWidth&&!n.clientHeight)throw new Error("Unknown window size, no known technique.");e.getWindowSize=function(){return new e.Point(document.body.clientWidth,document.body.clientHeight)}}return e.getWindowSize()},makeCenteredNode:function(t){t=e.getElement(t);var n=[e.makeNeutralElement("div"),e.makeNeutralElement("div"),e.makeNeutralElement("div")];return e.extend(n[0].style,{display:"table",height:"100%",width:"100%"}),e.extend(n[1].style,{display:"table-row"}),e.extend(n[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),n[0].appendChild(n[1]),n[1].appendChild(n[2]),n[2].appendChild(t),n[0]},makeNeutralElement:function(e){var t=document.createElement(e),n=t.style;return n.background="transparent none",n.border="none",n.margin="0px",n.padding="0px",n.position="static",t},now:function(){return Date.now?e.now=Date.now:e.now=function(){return(new Date).getTime()},e.now()},makeTransparentImage:function(t){return e.makeTransparentImage=function(t){var n=e.makeNeutralElement("img");return n.src=t,n},e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<7&&(e.makeTransparentImage=function(t){var n=e.makeNeutralElement("img"),r=null;return r=e.makeNeutralElement("span"),r.style.display="inline-block",n.onload=function(){r.style.width=r.style.width||n.width+"px",r.style.height=r.style.height||n.height+"px",n.onload=null,n=null},n.src=t,r.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')",r}),e.makeTransparentImage(t)},setElementOpacity:function(t,n,r){var i,s;t=e.getElement(t),r&&!e.Browser.alpha&&(n=Math.round(n)),e.Browser.opacity?t.style.opacity=n<1?n:"":n<1?(i=Math.round(100*n),s="alpha(opacity="+i+")",t.style.filter=s):t.style.filter=""},setElementTouchActionNone:function(t){t=e.getElement(t),typeof t.style.touchAction!="undefined"?t.style.touchAction="none":typeof t.style.msTouchAction!="undefined"&&(t.style.msTouchAction="none")},addClass:function(t,n){t=e.getElement(t),t.className?(" "+t.className+" ").indexOf(" "+n+" ")===-1&&(t.className+=" "+n):t.className=n},indexOf:function(e,t,n){return Array.prototype.indexOf?this.indexOf=function(e,t,n){return e.indexOf(t,n)}:this.indexOf=function(e,t,n){var r,i=n?n:0,s;if(!e)throw new TypeError;s=e.length;if(s===0||i>=s)return-1;i<0&&(i=s-Math.abs(i));for(r=i;r<s;r++)if(e[r]===t)return r;return-1},this.indexOf(e,t,n)},removeClass:function(t,n){var r,i=[],s;t=e.getElement(t),r=t.className.split(/\s+/);for(s=0;s<r.length;s++)r[s]&&r[s]!==n&&i.push(r[s]);t.className=i.join(" ")},addEvent:function(){if(window.addEventListener)return function(t,n,r,i){t=e.getElement(t),t.addEventListener(n,r,i)};if(window.attachEvent)return function(t,n,r,i){t=e.getElement(t),t.attachEvent("on"+n,r)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(t,n,r,i){t=e.getElement(t),t.removeEventListener(n,r,i)};if(window.detachEvent)return function(t,n,r,i){t=e.getElement(t),t.detachEvent("on"+n,r)};throw new Error("No known event model.")}(),cancelEvent:function(t){t=e.getEvent(t),t.preventDefault?e.cancelEvent=function(e){e.preventDefault()}:e.cancelEvent=function(t){t=e.getEvent(t),t.cancel=!0,t.returnValue=!1},e.cancelEvent(t)},stopEvent:function(t){t=e.getEvent(t),t.stopPropagation?e.stopEvent=function(e){e.stopPropagation()}:e.stopEvent=function(t){t=e.getEvent(t),t.cancelBubble=!0},e.stopEvent(t)},createCallback:function(e,t){var n=[],r;for(r=2;r<arguments.length;r++)n.push(arguments[r]);return function(){var r=n.concat([]),i;for(i=0;i<arguments.length;i++)r.push(arguments[i]);return t.apply(e,r)}},getUrlParameter:function(e){var t=n[e];return t?t:null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return t===null?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(t){var n;try{n=!!(new ActiveXObject("Microsoft.XMLHTTP"))}catch(r){n=!1}if(n)window.XMLHttpRequest?e.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:e.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");e.createAjaxRequest=function(){return new XMLHttpRequest}}return e.createAjaxRequest(t)},makeAjaxRequest:function(t,n,r){var i=e.getUrlProtocol(t),s=e.createAjaxRequest(i==="file:");if(!e.isFunction(n))throw new Error("makeAjaxRequest requires a success callback");s.onreadystatechange=function(){if(s.readyState==4){s.onreadystatechange=function(){};var o=i==="http:"||i==="https:"?200:0;s.status===o?n(s):(e.console.log("AJAX request returned %d: %s",s.status,t),e.isFunction(r)&&r(s))}};try{s.open("GET",t,!0),s.send(null)}catch(o){var u=o.message,a=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<10;a&&typeof o.number!="undefined"&&o.number==-2147024891&&(u+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),e.console.log("%s while making AJAX request: %s",o.name,u),s.onreadystatechange=function(){},e.isFunction(r)&&r(s,o)}},jsonp:function(t){var n,r=t.url,i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s=t.callbackName||"openseadragon"+e.now(),o=window[s],u="$1"+s+"$2",a=t.param||"callback",f=t.callback;r=r.replace(/(\=)\?(&|$)|\?\?/i,u),r+=(/\?/.test(r)?"&":"?")+a+"="+s,window[s]=function(t){if(!o)try{delete window[s]}catch(n){}else window[s]=o;f&&e.isFunction(f)&&f(t)},n=document.createElement("script");if(undefined!==t.async||!1!==t.async)n.async="async";t.scriptCharset&&(n.charset=t.scriptCharset),n.src=r,n.onload=n.onreadystatechange=function(e,t){if(t||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=undefined},i.insertBefore(n,i.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(t){if(window.DOMParser)e.parseXml=function(e){var t=null,n;return n=new DOMParser,t=n.parseFromString(e,"text/xml"),t};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");e.parseXml=function(e){var t=null;return t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e),t}}return e.parseXml(t)},imageFormatSupported:function(e){return e=e?e:"",!!t[e.toLowerCase()]}}),e.Browser={vendor:e.BROWSERS.UNKNOWN,version:0,alpha:!0};var t={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},n={};(function(){var t=navigator.appName,r=navigator.appVersion,i=navigator.userAgent,s;switch(navigator.appName){case"Microsoft Internet Explorer":!!window.attachEvent&&!!window.ActiveXObject&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(i.substring(i.indexOf("MSIE")+5,i.indexOf(";",i.indexOf("MSIE")))));break;case"Netscape":!window.addEventListener||(i.indexOf("Firefox")>=0?(e.Browser.vendor=e.BROWSERS.FIREFOX,e.Browser.version=parseFloat(i.substring(i.indexOf("Firefox")+8))):i.indexOf("Safari")>=0?(e.Browser.vendor=i.indexOf("Chrome")>=0?e.BROWSERS.CHROME:e.BROWSERS.SAFARI,e.Browser.version=parseFloat(i.substring(i.substring(0,i.indexOf("Safari")).lastIndexOf("/")+1,i.indexOf("Safari")))):(s=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),s.exec(i)!==null&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":e.Browser.vendor=e.BROWSERS.OPERA,e.Browser.version=parseFloat(r)}var o=window.location.search.substring(1),u=o.split("&"),a,f,l;for(l=0;l<u.length;l++)a=u[l],f=a.indexOf("="),f>0&&(n[a.substring(0,f)]=decodeURIComponent(a.substring(f+1)));e.Browser.alpha=!(e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9||e.Browser.vendor==e.BROWSERS.CHROME&&e.Browser.version<2),e.Browser.opacity=!(e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9)})();var r=function(e){};e.console=window.console||{log:r,debug:r,info:r,warn:r,error:r},function(t){var n=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,r=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame;if(n&&r)e.requestAnimationFrame=function(){return n.apply(t,arguments)},e.cancelAnimationFrame=function(){return r.apply(t,arguments)};else{var i=[],s=[],o=0,u;e.requestAnimationFrame=function(t){return i.push([++o,t]),u||(u=setInterval(function(){if(i.length){var t=e.now(),n=s;s=i,i=n;while(s.length)s.shift()[1](t)}else clearInterval(u),u=undefined},20)),o},e.cancelAnimationFrame=function(e){var t,n;for(t=0,n=i.length;t<n;t+=1)if(i[t][0]===e){i.splice(t,1);return}for(t=0,n=s.length;t<n;t+=1)if(s[t][0]===e){s.splice(t,1);return}}}}(window),e._processDZIError=function(e){var t=e.getElementsByTagName("Message")[0],n=t.firstChild.nodeValue;throw new Error(n)}}(OpenSeadragon)}.call(e),t})})(this);